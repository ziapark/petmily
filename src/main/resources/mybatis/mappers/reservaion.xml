<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
	PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
	"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.petmillie.reservation.dao.ReservaionDAO">

	<resultMap id="pensionDetailResult" type="com.petmillie.business.vo.PensionVO">
		<result property="p_num" column="p_num" />
		<result property="business_id" column="business_id" />
		<result property="p_name" column="p_name" />
		<result property="tel1" column="tel1" />
		<result property="tel2" column="tel2" />
		<result property="tel3" column="tel3" />
		<result property="checkin_time" column="checkin_time" />
		<result property="checkout_time" column="checkout_time" />
		<result property="facilities" column="facilities" />
		<result property="description" column="description" />
		
		<association property="business" javaType="com.petmillie.business.vo.BusinessVO">
			<result property="roadAddress" column="roadAddress"/>
			<result property="jibunAddress" column="jibunAddress"/>
		</association>
	</resultMap>

	<resultMap id="roomResult" type="com.petmillie.business.vo.RoomVO">
		<result property="room_id" column="room_id"/>
		<result property="p_num" column="p_num"/>
		<result property="room_name" column="room_name"/>
		<result property="room_type" column="room_type"/>
		<result property="price" column="price"/>
		<result property="max_capacity" column="max_capacity"/>
		<result property="bed_type" column="bed_type"/>
		<result property="room_size" column="room_size"/>
		<result property="room_description" column="room_description"/>
		<result property="amenities" column="amenities"/>
		<result property="reg_date" column="reg_date"/>
		<result property="del_yn" column="del_yn"/>
		<result property="fileimage" column="fileimage"/>
	</resultMap>


	<select id="selectAllPensionList" resultType="com.petmillie.business.vo.PensionVO">
		<![CDATA[
			SELECT * FROM pension WHERE del_yn = 'N' ORDER BY p_num DESC
		]]>
	</select>
	
	
	<select id="selectPensionDetail" resultMap="pensionDetailResult" parameterType="int">
		<![CDATA[
			SELECT
				p.*, b.roadAddress, b.jibunAddress
			FROM
				pension p
			JOIN
				business b ON p.business_id = b.business_id
			WHERE
				p.p_num = #{p_num}
		]]>
	</select>

	<select id="selectRoomList" resultMap="roomResult" parameterType="int">
		<![CDATA[
			SELECT * FROM room WHERE p_num = #{p_num} AND del_yn = 'N' ORDER BY price ASC
		]]>
	</select>

</mapper>