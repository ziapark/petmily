<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
	PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
	"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="mapper.admin.order">

	<!-- OrderVO용 ResultMap -->
	<resultMap id="adminorderResult" type="com.petmillie.order.vo.OrderVO">
		<result property="order_num" column="order_num" />
		<result property="member_id" column="member_id" />
		<result property="order_id" column="order_id" />
		<result property="goods_num" column="goods_num" />
		<result property="goods_name" column="goods_name" />
		<result property="goods_sales_price" column="goods_sales_price" />
		<result property="total_price" column="total_price" />
		<result property="goods_qty" column="goods_qty" />
		<result property="order_name" column="order_name" />
		<result property="receiver_name" column="receiver_name" />
		<result property="tel1" column="tel1" />
		<result property="tel2" column="tel2" />
		<result property="tel3" column="tel3" />
		<result property="zipcode" column="zipcode" />
		<result property="roadAddress" column="roadAddress" />
		<result property="jibunAddress" column="jibunAddress" />
		<result property="namujiAddress" column="namujiAddress" />
		<result property="delivery_method" column="delivery_method" />
		<result property="pay_order_tel" column="pay_order_tel" />
		<result property="delivery_message" column="delivery_message" />
		<result property="delivery_state" column="delivery_state" />
		<result property="goods_fileName" column="goods_fileName" />
		<result property="order_time" column="order_time" />
	</resultMap>

	<!-- PayVO용 ResultMap -->
	<resultMap id="adminpayResult" type="com.petmillie.order.vo.PayVO">
		<result property="payment_id" column="payment_id" />
		<result property="pay_method" column="pay_method" />
		<result property="card_com_name" column="card_com_name" />
		<result property="card_pay_month" column="card_pay_month" />
		<result property="final_total_price" column="final_total_price" />
		<result property="pay_order_time" column="pay_order_time" />
		<result property="order_num" column="order_num" />
		<result property="payment_amount" column="payment_amount" />
		<result property="payment_status" column="payment_status" />
		<result property="pg_tid" column="pg_tid" />
		<result property="payment_time" column="payment_time" />
		<result property="pay_order_tel" column="pay_order_tel" />
	</resultMap>

	<!-- memberVO용 ResultMap -->
	<resultMap id="adminmemberResult" type="com.petmillie.member.vo.MemberVO">
		<result property="member_id" column="member_id" />
		<result property="member_pw" column="member_pw" />
		<result property="member_name" column="member_name" />
		<result property="member_gender" column="member_gender" />
		<result property="member_birth_y" column="member_birth_y" />
		<result property="member_birth_m" column="member_birth_m" />
		<result property="member_birth_d" column="member_birth_d" />
		<result property="member_birth_gn" column="member_birth_gn" />
		<result property="tel1" column="tel1" />
		<result property="tel2" column="tel2" />
		<result property="tel3" column="tel3" />
		<result property="smssts_yn" column="smssts_yn" />
		<result property="email1" column="email1" />
		<result property="email2" column="email2" />
		<result property="emailsts_yn" column="emailsts_yn" />
		<result property="zipcode" column="zipcode" />
		<result property="roadAddress" column="roadAddress" />
		<result property="jibunAddress" column="jibunAddress" />
		<result property="namujiAddress" column="namujiAddress" />
		<result property="joinDate" column="joinDate" />
	</resultMap>

	<select id="selectNewOrderList" resultMap="adminorderResult" parameterType="java.util.Map">
		<![CDATA[
			SELECT *
			FROM userorder
			WHERE DATE_FORMAT(order_time, '%Y-%m-%d') BETWEEN #{beginDate} AND #{endDate}
			ORDER BY order_time DESC
			LIMIT #{offset}, #{limit}
		]]>
	</select>

	<update id="updateDeliveryState" parameterType="java.util.Map">
		UPDATE userorder
		<set>
			<if test="delivery_state != null and delivery_state != ''">
				delivery_state = #{delivery_state}
			</if>
		</set>
		WHERE order_id = #{order_id}
	</update>

	<select id="selectOrderDetail" resultMap="adminorderResult" parameterType="int">
		<![CDATA[
			SELECT * FROM userorder WHERE order_id = #{order_id}
		]]>
	</select>

	<select id="selectOrderer" resultMap="adminmemberResult" parameterType="String">
		<![CDATA[
			SELECT * FROM member WHERE member_id = #{member_id}
		]]>
	</select>

</mapper>